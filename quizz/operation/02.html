<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Quizz</title>
</head>
<body>
<aside style="display:none;">connaissances nécessaire: number, précision</aside>
thème: opérateur<br>
niveau: 0<br><br>
<b>code:</b><br>
<textarea rows="20" cols="100" id="question">
var i = 0 || "A";

alert( i );
</textarea>

<hr>
<b>Question:</b> Qu'est-ce qui s'affiche si on exécute ce code?
<ul>
	<li>false</li>
	<li>true</li>
	<li>0</li>
	<li class="bonneReponse">A</li>
	<li>Une erreur survient</li>
</ul>
<br>
<hr>
<br>
<b>Résultat</b> <i>essayez vous-même</i>:
<br>
<input type="button" id="input" value="tester" onclick="test()">


<details style="margin-top:3em;border:1px solid black;display:block;">
	<summary>Explication</summary>
<minioce type="javascript">||</minicode> correspond en JavaScript à l'opérateur logique OU. Mais contrairement à beaucoup de langages, son résultat n'est pas un forcément un booléen&nbsp;!<br>
Le véritable fonctionnement de cet opérateur est&nbsp;: si le premier opérande est équivalent à <minicode type="javascript">true</minicode> lorsqu'il est converti en booléen, alors le résultat vaut le premier opérande, sinon il vaut le deuxième opérande. Ainsi quand les deux opérandes sont des booléens, on retrouve bien l'opérateur OU du booléen (qui retourne <minicode type="javascript">true</minicode> si un des deux opérandes vaut <minicode type="javascript">true</minicode>). Mais quand les opérandes ne sont pas des booléens, l'interpréteur analyse leur équivalent en booléen mais retourne la valeur de l'un des deux opérandes.<br>
Un nombre est équivalent à <minicode type="javascript">false</minicode> s'il vaut <minicode type="javascript">0</minicode> ou <minicode type="javascript">NaN</minicode>, sinon il est équivalent à <minicode type="javascript">true</minicode>.<br>
Une chaîne de caractères est équivalente à <minicode type="javascript">false</minicode> si elle vaut <minicode type="javascript">""</minicode> (chaîne vide), sinon elle est équivalente à <minicode type="javascript">true</minicode> (même si elle vaut <minicode type="javascript">"false"</minicode>).<br>
Un objet est équivalent à <minicode type="javascript">false</minicode> uniquement s'il vaut <minicode type="javascript">null</minicode>.<br>
Une variable non définie (<minicode type="javascript">undefined</minicode>) est équivalente à <minicode type="javascript">false</minicode>.<br>
<br>
Cette écriture est très souvent utilisée pour attribuer une valeur par défaut à un argument&nbsp;:<br>
<minicode type="javascript">function f(s){</minicode><br>
<minicode type="javascript">  s = s || "toto"; //s vaut s (si l'argument s est défini) sinon il vaut "toto"</minicode><br>
<minicode type="javascript">}</minicode><br>
</details>

<script>
function test(){
	var code = document.getElementById("question").value;
	if(!/alert\(/.test(code)){
		code = code.replace(/(?:^|[\r\n])(?:[\r\n]|$)/g,"").replace(/(^|[\n\r;])([^;\r\n]+);?$/,"$1alert($2);");
	}
	try{
		var f=new Function(code);
	}catch(e){
		alert("ERROR while creating test\n"+e.message);
	}
	if(f){
		try{
			f();
		}catch(e){
			alert("ERROR\n"+e.message);
		}
	}
}
</script>

</body>
</html>
