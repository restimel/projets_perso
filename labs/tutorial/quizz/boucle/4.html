<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
</head>
<body>
<aside style="display:none;">connaissances nécessaire: portée</aside>
thème: boucle,portée<br>
niveau: 0<br><br>
<b>code:</b><br>
<textarea rows="20" cols="100" id="question">
for(var i=0; i<1; i++){}

alert( i );
</textarea>

<hr>
<b>Question:</b> Qu'est-ce qui s'affiche si on exécute ce code?
<ul>
	<li>0</li>
	<li class="bonneReponse">1</li>
	<li>2</li>
	<li>null</li>
	<li>undefined</li>
	<li>Une erreur survient</li>
</ul>
<hr>
<br>
<b>Résultat</b> <i>essayez vous-même</i>:
<br>
<input type="button" id="input" value="tester" onclick="test()">


<details style="margin-top:3em;border:1px solid black;display:block;">
	<summary>Explication</summary>
En JavaScript, la portée des variables n'est affectée que par les fonctions. Les blocs de codes, comme celle des boucles, n'affectent pas la portée des variables. Ainsi déclarer une variable dans une boucle ou à l'extérieur reviendra au même et sera accessible au mêmes endroits.<br>
Une boucle <minicode type="javascript">for</minicode> se compose de trois parties. La première est l'initialisation, elle est exécutée une seule fois au début de la boucle. La deuxième est la partie de la condition, au début de chaque itération on vérifie si la condition est vraie. Si elle l'est alors on démarre une nouvelle itération sinon on arrête la boucle. La troisième partie est celle de l'incrémentation, elle est exécutée après chaque itération.<br>
<br>
Dans le cas de ce code, il n'y a pas de code à l'intérieur de la boucle mais celle-ci procède quand même aux différentes étapes propres aux boucle <minicode type="javascript">for</minicode>. <minicode type="javascript">i</minicode> est initialisé à <minicode type="javascript">0</minicode>. Puis on vérifie qu'elle est inférieure à <minicode type="javascript">1</minicode>. Vu qu'il n'y a pas de code à exécuter, on passe directement à l'incrméntation où <minicode type="javascript">i</minicode> vaut maintenant <minicode type="javascript">1</minicode>). On test à nouveau la condition qui est maintenant fausse et on arrête la boucle.<br>
À la fin de la boucle <minicode type="javascript">i</minicode> vaut <minicode type="javascript">1</minicode> et est parfaitement accessible par la fonction <minicode type="javascript">alert</minicode>.
</details>

<script>
function test(){
	var code = document.getElementById("question").value;
	if(!/alert\(/.test(code)){
		code = code.replace(/(?:^|[\r\n])(?:[\r\n]|$)/g,"").replace(/(^|[\n\r;])([^;\r\n]+);?$/,"$1alert($2);");
	}
	try{
		var f=new Function(code);
	}catch(e){
		alert("ERROR while creating test\n"+e.message);
	}
	if(f){
		try{
			f();
		}catch(e){
			alert("ERROR\n"+e.message);
		}
	}
}
</script>

</body>
</html>
